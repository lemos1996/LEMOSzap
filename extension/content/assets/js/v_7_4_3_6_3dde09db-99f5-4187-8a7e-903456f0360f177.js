import{r as x,j as e}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f.js";import{e as O,F as R}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f6.js";import{u as B}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f31.js";import{u as G,g as F}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f20.js";import{m as X,b3 as Q,b4 as V}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f23.js";import{A as q}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f179.js";import{M as J}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f133.js";import{D as K,bp as Y,H as Z,ao as ee,Q as te,U as se,au as ae}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f11.js";import{W as v}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f19.js";import{a as re}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f108.js";import{U as le}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f62.js";import{c as ie,d as ne,e as oe}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f154.js";import{b as ce}from"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f153.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f8.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f7.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f4.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f3.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f2.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f10.js";import"./v_7_4_3_6_3dde09db-99f5-4187-8a7e-903456f0360f9.js";function de({userId:n,name:m}){const{agendamentosNaoDisparados:c,removeAgendamento:N,enviarAgendamento:A,buttonActive:r,openUserChat:y,setButtonActive:w,agendamentos:D}=B(),[o,I]=x.useState(r?c:c.filter(a=>a.userID===n)),{language:t}=G(),{plugin_page:T}=F(),[C,M]=x.useState(new Map),E=async a=>{const l=await v.Contact("getProfilePictureUrl",a),{name:s}=await v.Utils("getContato",a);return{nome:s,base64:l}},k=async a=>{const l=Array.from(new Set(a.map(i=>i.userID))),s=new Map;for(const i of l){const d=await E(i);s.set(i,d)}M(s)};x.useEffect(()=>{k(o)},[o]);const p=a=>C.get(a)||{nome:"",base64:""};x.useEffect(()=>{const a=new Date().getTime(),s=(r?c:c.filter(i=>i.userID===n)).sort((i,d)=>{const L=new Date(`${i.data}T${i.hora}:00`).getTime(),$=new Date(`${d.data}T${d.hora}:00`).getTime(),P=Math.abs(L-a),W=Math.abs($-a);return P-W});I(s)},[c,r,n,D]);const{open:f}=X(),g=50,u=37,j="calc(85vh - 300px)",h="950px",_=()=>{const a=o.length*g+u,l=parseInt(j.replace(/[^\d]/g,""));return Math.min(a,l)},H=a=>{f(e.jsx(q,{agendamento:a,create:!1,userId:n,name:m,tipo:"relatorio"}))},b=()=>{f(e.jsx(J,{userId:n,name:m}))},S=a=>{y(a.userID),f(e.jsx(de,{userId:a.userID,name:m}))},U=({index:a,style:l})=>{const s=o[a];return e.jsxs("div",{style:l,className:"flex items-center hover:bg-base-200 rounded-lg cursor-pointer h-full border-solid border-b border-[var(--border-list)] last-of-type:border-none",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("span",{className:"break-words truncate",style:{maxWidth:"100px"},children:s.titulo})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[p(s.userID).base64==="undefined"?e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",children:e.jsx(le,{})}):e.jsx("img",{src:p(s.userID).base64,className:"w-8 h-8 rounded-full object-cover",alt:"User"}),e.jsx("p",{className:"break-words truncate",style:{maxWidth:"92px"},children:p(s.userID).nome})]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.tipo}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:se.converterData(s.data)}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.hora}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.recorrenciaManual?s.recorrencia?`${s.recorrencia} ${t.dias}`:t.vazia:t[s.recorrencia]||t.vazia}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("span",{className:"break-words truncate",style:{maxWidth:"100px"},children:s.status==="enviado"?e.jsx("div",{className:"badge badge-accent text-[var(--letra)]",children:t.agenEnviado}):e.jsx("div",{className:"badge badge-error text-[var(--letra)]",children:t.agenErro})})}),e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-1",children:[e.jsx("span",{className:"pulse",onClick:()=>H(s),children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("span",{className:"pulse",onClick:()=>N(s.id,"relatorio"),children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("span",{className:"pulse lg:tooltip lg:tooltip-bottom",onClick:()=>A(s),"data-tip":t.enviar,children:e.jsx(oe,{className:"h-4 w-4"})}),r&&n!==s.userID&&!T&&e.jsx("span",{className:"pulse lg:tooltip lg:tooltip-left",onClick:()=>S(s),"data-tip":t.agenOpenChat,children:e.jsx(V,{className:"h-4 w-4"})})]})]},s.id)},z=()=>e.jsx("div",{className:"w-full border-collapse",children:e.jsxs("div",{className:"flex font-bold",children:[e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_titulo}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_cliente}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_tipo}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_data}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_hora}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_recorrencia}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.status}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_acao})]})});return e.jsxs("div",{className:"grid gap-4",style:{maxHeight:"90vh",width:h},children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"w-full flex items-center justify-between pr-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{children:t.relatorioTitle}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-bottom tooltip-w-fit","data-tip":t.relInfoDesc,children:e.jsx("span",{className:"pulse   before:!w-44 mt-1.5",children:e.jsx(Y,{className:"w-5 h-5 text-[var(--icon)]"})})}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-right","data-tip":t.voltar,onClick:b,children:e.jsx("span",{className:"pulse",children:e.jsx(ce,{className:"w-6 h-6 text-[var(--primaria)]"})})})]}),e.jsx("button",{className:`border-solid border-[var(--primary)] border rounded-full text-center
            ${r?"bg-[var(--primary-muted)] text-white":"bg-transparent text-[var(--primary)]"}
            self-center px-3 py-[4px] pulse lg:tooltip lg:tooltip-bottom text-sm transition-all duration-300 ease-in`,onClick:()=>w(!r),"data-tip":r?t.ocultarContatosDesc:t.exibirContatosDesc,children:e.jsxs("span",{className:"inline-flex items-center gap-0.5",children:[r?t.ocultar:t.exibirTodos,r?e.jsx(ie,{}):e.jsx(ne,{})]})})]}),e.jsx(Z,{children:"Exibe o relatório dos últimos 30 envios realizados"})]}),e.jsx("div",{children:o.length>0?e.jsxs("div",{style:{height:_(),maxHeight:j,width:"100%"},children:[e.jsx(z,{}),e.jsx(O,{children:({height:a,width:l})=>e.jsx(R,{className:"AAAAAAAAAAAAAAAAAA",height:a-u,itemCount:o.length,itemSize:g,width:h,style:{overflowX:"hidden",width:h},children:U})})]}):e.jsx("div",{className:"!h-fit",children:e.jsx(ee,{title:t.relNenhumAgendamentoErro,description:t.relDescricaoAgendamentos,icon:e.jsx(Q,{className:"w-7 h-7 text-[var(--primaria)]"})})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(te,{name:t.voltar,funcao:b})})]})}export{de as default};
